# SmartUI Migration Tool

A sophisticated command-line interface (CLI) designed to help enterprise QA and developers migrate their existing visual testing suites (from Percy, Applitools, and Sauce Labs) to LambdaTest SmartUI.

## Features

- **Interactive CLI Experience**: Modern, user-friendly command-line interface with visual feedback
- **Human-First Design**: Clear prompts and user control with elegant spinners and progress indicators
- **Automated Mode**: `--yes` flag for CI/CD integration without interactive prompts
- **Intelligent Project Scanner**: Automatically detects visual testing platforms, frameworks, and languages
- **Configuration Transformation**: Converts Percy, Applitools, and Sauce Labs configs to SmartUI format
- **Multi-Framework Support**: Migrate from Percy, Applitools, and Sauce Labs
- **Multi-Language Support**: JavaScript/TypeScript, Java, and Python projects
- **AST-Based Code Transformation**: Intelligent analysis and transformation of test scripts
- **Configuration Migration**: Automatic conversion of framework-specific configurations
- **CI/CD Integration**: Updates package.json scripts and CI/CD configurations
- **Comprehensive Reporting**: Detailed migration reports with statistics and recommendations
- **Secure & Local**: Runs 100% locally on your machine for maximum security

## Installation

### Option 1: Download Pre-built Binary (Recommended)

Download the appropriate binary for your operating system from the [GitHub Releases](https://github.com/lambdatest/smartui-migration-tool/releases) page:

- **Linux (x64)**: `smartui-migration-tool-linux`
- **macOS (Intel)**: `smartui-migration-tool-macos`
- **macOS (Apple Silicon)**: `smartui-migration-tool-macos-arm64`
- **Windows (x64)**: `smartui-migration-tool-win.exe`

#### Installation Steps:

1. **Download** the appropriate binary for your operating system
2. **Make executable** (Linux/macOS):
   ```bash
   chmod +x smartui-migration-tool-*
   ```
3. **Move to PATH** (optional) or run directly:
   ```bash
   # Run directly
   ./smartui-migration-tool-* migrate
   
   # Or move to PATH for global access
   sudo mv smartui-migration-tool-* /usr/local/bin/smartui-migrator
   smartui-migrator migrate
   ```

### Option 2: Install via npm (Development)

For development or if you prefer npm installation:

```bash
npm install -g smartui-migration-tool
```

Then run:
```bash
smartui-migrator migrate
```

## Supported Platforms & Frameworks

The SmartUI Migration Tool automatically detects and supports migration from:

### **Visual Testing Platforms:**
- **Percy** - Visual testing by BrowserStack
- **Applitools** - AI-powered visual testing
- **Sauce Labs Visual** - Visual testing by Sauce Labs

### **Test Frameworks:**
- **Cypress** - JavaScript/TypeScript end-to-end testing
- **Playwright** - Cross-browser testing framework
- **Selenium** - Web browser automation
- **Storybook** - Component development environment
- **Robot Framework** - Python-based test automation

### **Programming Languages:**
- **JavaScript/TypeScript** - Node.js projects
- **Java** - Maven-based projects
- **Python** - Requirements.txt-based projects

## Configuration Transformation

The tool automatically transforms configuration files from supported platforms to SmartUI format:

### **Percy Configuration Support:**
- **`.percy.yml`** - Percy v2 configuration files
- **`.percyrc`** - Alternative Percy configuration format
- **Property Mapping:**
  - `snapshot.widths` â†’ `web.viewports` (converted to SmartUI format)
  - `discovery.allowed-hostnames` â†’ `web.allowedHostnames`
  - `snapshot.min-height` â†’ `web.minHeight`
- **Feature Gap Handling:**
  - `percy-css` properties are flagged for code transformation
  - `enable-javascript` settings are noted for test-level handling

### **Applitools Configuration Support:**
- **`applitools.config.js`** - JavaScript configuration files
- **Secure AST Parsing**: Uses Abstract Syntax Tree parsing to safely extract configuration without executing user code
- **Property Mapping:**
  - `browser` array â†’ Separated into `web.browsers`, `web.viewports`, and `mobile.devices`
  - Desktop objects `{width, height, name}` â†’ Web browser and viewport configurations
  - Mobile objects `{deviceName, screenOrientation}` â†’ Mobile device configurations
- **Feature Gap Handling:**
  - `appName`, `batchName` â†’ Dashboard/CLI configuration (not migrated)
  - `apiKey`, `serverUrl` â†’ Environment variables/CLI arguments (not migrated)
  - `batchId` â†’ Auto-generated by SmartUI (not migrated)

### **Sauce Labs Configuration Support:**
- **`saucectl.yml`** - YAML configuration files for Sauce Labs Visual
- **Framework-embedded configs** - JavaScript/TypeScript files with `saucelabs` or `sauceVisual` properties
- **Dual Format Support**: Handles both YAML and JavaScript configuration sources
- **Property Mapping:**
  - `browserName` â†’ `web.browsers` array
  - `screenResolution` (e.g., "1920x1080") â†’ `web.viewports` array `[[1920, 1080]]`
  - `deviceName` â†’ `mobile.devices` array
  - Complex suite configurations with nested `browsers` and `devices` arrays
- **Feature Gap Handling:**
  - `build`, `name`, `tags` â†’ CLI arguments/environment variables (not migrated)
  - `region`, `username`, `accessKey` â†’ CLI arguments/environment variables (not migrated)

## Installation

```bash
# Clone the repository
git clone <repository-url>
cd smartui-migration-tool

# Install dependencies
npm install
# or
pnpm install

# Build the project
npm run build
```

## Usage

### Basic Migration

```bash
# Run the migration tool
npm start migrate

# Or use the built binary
./bin/run migrate
```

### Advanced Options

```bash
# Specify project path
npm start migrate --project-path ./my-project

# Dry run (no actual changes)
npm start migrate --dry-run

# Skip backups
npm start migrate --no-backup

# Verbose output
npm start migrate --verbose

# Automated mode (skip interactive prompts for CI/CD)
npm start migrate --yes

# Migrate specific framework
npm start migrate percy
```

## Project Structure

```
src/
â”œâ”€â”€ commands/          # CLI commands
â”‚   â””â”€â”€ migrate.ts     # Main migration command
â”œâ”€â”€ modules/           # Core migration modules
â”‚   â”œâ”€â”€ Scanner.ts     # Intelligent project analysis and detection
â”‚   â”œâ”€â”€ ConfigTransformer.ts  # Configuration conversion
â”‚   â”œâ”€â”€ CodeTransformer.ts    # Code transformation
â”‚   â”œâ”€â”€ ExecutionTransformer.ts # CI/CD updates
â”‚   â””â”€â”€ Reporter.ts    # Report generation
â”œâ”€â”€ types/             # Shared type definitions
â”‚   â””â”€â”€ index.ts       # Type definitions
â”œâ”€â”€ utils/             # Utility functions
â”‚   â””â”€â”€ welcome.ts     # Welcome screen
â”œâ”€â”€ cli.ts             # Interactive CLI workflow
docs/                  # Architectural documentation
â””â”€â”€ transformation_strategy.md  # AST vs Regex mandate
```

## Development

### Prerequisites

- Node.js >= 18.0.0
- npm, yarn, or pnpm

### Scripts

```bash
# Development with watch mode
npm run dev

# Build the project
npm run build

# Lint code
npm run lint

# Fix linting issues
npm run lint:fix

# Format code
npm run format
```

### Code Quality

This project uses:
- **TypeScript** for type safety
- **ESLint** for code linting
- **Prettier** for code formatting
- **oclif** for CLI framework

## Architectural Principles

The SmartUI Migration Tool follows strict architectural principles to ensure enterprise-grade reliability:

- **ðŸ“‹ [Transformation Strategy](docs/transformation_strategy.md)**: Mandatory use of Abstract Syntax Trees (AST) for all code transformations. Regular Expressions are strictly prohibited for code modification.

This ensures that all code transformations are:
- âœ… **100% accurate** and **structurally sound**
- âœ… **Safe** for production enterprise codebases
- âœ… **Reliable** across different code formatting styles
- âœ… **Future-proof** for advanced transformation scenarios

## Testing and Validation

The SmartUI Migration Tool has been thoroughly tested and validated:

- **âœ… Comprehensive Test Suite**: Unit and integration tests with Jest
- **âœ… Cross-Platform Validation**: All executables tested on Windows, macOS (Intel/ARM), and Linux
- **âœ… Multi-Language Support**: Tested with JavaScript/TypeScript, Java, and Python projects
- **âœ… Multi-Framework Support**: Validated with Cypress, Playwright, Selenium, Storybook, and Appium
- **âœ… Error Handling**: Robust error handling with user-friendly messages
- **âœ… Performance Testing**: Optimized for large projects and fast execution

For detailed validation results, see [VALIDATION.md](VALIDATION.md).

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Run tests and linting
5. Submit a pull request

## License

MIT License - see LICENSE file for details.

## Support

For support and questions, please contact the LambdaTest team or create an issue in the repository.
